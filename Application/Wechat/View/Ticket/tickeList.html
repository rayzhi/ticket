<extend name="template/template" />

<block name="css">
	<style type="text/css">
	  
	</style>
</block>

<block name="content">

 <body>
 
	 <form id="h-form" method="post" enctype="multipart/form-data" action="javascript:;" >
	    <div class="panel margin-top">
	        <h3 class="maintext">魔乐城场馆体验票</h3>
	        <p class="mainprice">￥99.0</p>
	        <input type="hidden" name="ticket_id" value="1">
	    </div>
	
	    <div class="panel margin-top" href="#">
	        <select name="area" class="selectarea required">
	            <option value="">请选择场地</option>
	            <option value="1">场地1</option>
	            <option value="2">场地2</option>
	            <option value="3">场地3</option>
	        </select>
	        <div class="selectnum">
	            <span class="text">数量</span>
	            <div class="numer margin-left30">
	                <span class="minus">- </span>
	                <input type="text" name="amount" class="numval" value="1">
	                <span class="plus">+</span>
	            </div>
	        </div>
	    </div>
	
	    <div class="margin-top30">&nbsp;</div>
	    <div class="container">
	    	<button type="submit" class="btn-block margin-top">立即购买</button>
	    </div>
	</form>
  </body>
</block>


<block name="script">
	<script>
		
		//提交表单
		$('.btn-block').click(function(){
			if($("#h-form").valid()){
				var index = layer.load(0,{shade:[0.3,'#676767']});
				data = $("form").serialize();			
				$.post(
					"{:UC('Wechat/Ticket/makeOrder')}", 
					data, 
				    function(obj){
						if(obj.status == 1){
							window.location.href = "{:UC('Wechat/Ticket/doPay')}?order_id="+obj.url;
						}else{
							layer.msg(data.info,{time:1000},function(){
								layer.close(index);
							});
						}
					},
					'json'
				);
			}
		})
		
	</script>
</block>

